import jlib from 'jingtum-lib';
import ipfsAPI from 'ipfs-api';
import mysql from 'mysql';
import sqlText from 'node-transform-mysql';

import * as requestInfo from '../utils/jingtum/requestInfo.js';
import * as contract from '../utils/jingtum/contract.js';
import * as ipfsUtils from '../utils/ipfsUtils.js';
import * as mysqlUtils from '../utils/mysqlUtils.js';

import {chains, ipfsConf, mysqlConf} from '../utils/info.js';

const ipfs = ipfsAPI(ipfsConf); // ipfs连接
const c = mysql.createConnection(mysqlConf);
c.connect(); // mysql连接
const contractChain = chains[1];
//买单合约：智能交易系统 卖单合约：平台
const platformAddr = contractChain.account.a[5].address;
const platformSecret = contractChain.account.a[5].secret;
// 一次部署一个 abi 和 payload
const abi = [{"constant":false,"inputs":[{"name":"order_id","type":"bytes32"},{"name":"taker_address","type":"address"},{"name":"mono","type":"bool"}],"name":"commitOrder","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"order_id","type":"bytes32"},{"name":"label_ref","type":"string"},{"name":"price_ref","type":"string"}],"name":"updateAdditionInfoRef","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"order_id","type":"bytes32"},{"name":"expire_time","type":"uint32"},{"name":"other_clauses","type":"string"}],"name":"makeBuyIntention","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"}],"name":"addAdmin","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"order_id","type":"bytes32"}],"name":"cancelOrder","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"order_id","type":"bytes32"}],"name":"getOrderInfo","outputs":[{"components":[{"components":[{"name":"asset_id","type":"bytes32[]"},{"name":"asset_type","type":"uint8"},{"name":"consumable","type":"bool"}],"name":"order_type","type":"tuple"},{"name":"expire_time","type":"uint256"},{"name":"label_ref","type":"string"},{"name":"price_ref","type":"string"},{"name":"other_clause","type":"string"},{"name":"status","type":"bool"}],"name":"","type":"tuple"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"order_id","type":"bytes32"},{"name":"asset_id","type":"bytes32[]"},{"name":"asset_type","type":"uint8"},{"name":"consumable","type":"bool"},{"name":"expire_time","type":"uint32"},{"name":"other_clauses","type":"string"}],"name":"makeOrder","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"}],"name":"addChecker","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getTimeStamp","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}];
const payload = '60806040526000339050806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060018060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506001600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555050611daf806101086000396000f3fe608060405234801561001057600080fd5b50600436106100b0576000357c0100000000000000000000000000000000000000000000000000000000900480637489ec23116100835780637489ec2314610125578063768c6ec014610141578063893aa97614610171578063916473ab1461018d578063da235b22146101a9576100b0565b806310e8da53146100b55780634c6907dc146100d15780636bd18728146100ed5780637048027514610109575b600080fd5b6100cf60048036036100ca91908101906115da565b6101c7565b005b6100eb60048036036100e691908101906116ec565b6104af565b005b61010760048036036101029190810190611775565b6105fe565b005b610123600480360361011e9190810190611588565b610749565b005b61013f600480360361013a91908101906115b1565b6107e6565b005b61015b600480360361015691908101906115b1565b61099a565b6040516101689190611c32565b60405180910390f35b61018b60048036036101869190810190611629565b610c78565b005b6101a760048036036101a29190810190611588565b611079565b005b6101b1611116565b6040516101be9190611c54565b60405180910390f35b60011515600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16151514151561025c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161025390611bb2565b60405180910390fd5b826003600082815260200190815260200160002060060160009054906101000a900460ff1615156102c2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102b990611b52565b60405180910390fd5b426004600086815260200190815260200160002060000160008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015411151561035c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161035390611b72565b60405180910390fd5b6003600085815260200190815260200160002060000160010160019054906101000a900460ff168061038b5750815b1561044a57600360008581526020019081526020016000206000808201600080820160006103b991906111dc565b6001820160006101000a81549060ff02191690556001820160016101000a81549060ff0219169055505060028201600090556003820160006103fb91906111fd565b60048201600061040b91906111fd565b60058201600061041b91906111fd565b6006820160006101000a81549060ff0219169055505060046000858152602001908152602001600020506104a9565b6004600085815260200190815260200160002060000160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008082016000905550505b50505050565b60011515600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161515141515610544576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161053b90611bb2565b60405180910390fd5b846003600082815260200190815260200160002060060160009054906101000a900460ff1615156105aa576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016105a190611b52565b60405180910390fd5b84846003600089815260200190815260200160002060030191906105cf929190611245565b5082826003600089815260200190815260200160002060040191906105f5929190611245565b50505050505050565b836003600082815260200190815260200160002060060160009054906101000a900460ff161515610664576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161065b90611b52565b60405180910390fd5b4260036000878152602001908152602001600020600201541115156106be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106b590611c12565b60405180910390fd5b6106c66112c5565b6020604051908101604052808663ffffffff1642018152509050806004600088815260200190815260200160002060000160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000155905050505050505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156107da576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107d190611b92565b60405180910390fd5b6107e38161111e565b50565b60011515600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16151514151561087b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161087290611bb2565b60405180910390fd5b806003600082815260200190815260200160002060060160009054906101000a900460ff1615156108e1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016108d890611b52565b60405180910390fd5b6003600083815260200190815260200160002060008082016000808201600061090a91906111dc565b6001820160006101000a81549060ff02191690556001820160016101000a81549060ff02191690555050600282016000905560038201600061094c91906111fd565b60048201600061095c91906111fd565b60058201600061096c91906111fd565b6006820160006101000a81549060ff0219169055505060046000838152602001908152602001600020505050565b6109a26112d9565b6003600083815260200190815260200160002060c06040519081016040529081600082016060604051908101604052908160008201805480602002602001604051908101604052809291908181526020018280548015610a2157602002820191906000526020600020905b815481526020019060010190808311610a0d575b505050505081526020016001820160009054906101000a900460ff1660ff1660ff1681526020016001820160019054906101000a900460ff161515151581525050815260200160028201548152602001600382018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610b095780601f10610ade57610100808354040283529160200191610b09565b820191906000526020600020905b815481529060010190602001808311610aec57829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610bab5780601f10610b8057610100808354040283529160200191610bab565b820191906000526020600020905b815481529060010190602001808311610b8e57829003601f168201915b50505050508152602001600582018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c4d5780601f10610c2257610100808354040283529160200191610c4d565b820191906000526020600020905b815481529060010190602001808311610c3057829003601f168201915b505050505081526020016006820160009054906101000a900460ff1615151515815250509050919050565b60011515600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161515141515610d0d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d0490611bb2565b60405180910390fd5b876003600082815260200190815260200160002060060160009054906101000a900460ff16151515610d74576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d6b90611bd2565b60405180910390fd5b600360008a815260200190815260200160002060060160009054906101000a900460ff16151515610dda576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610dd190611bd2565b60405180910390fd5b60028660ff16141580610dea5750845b1515610e2b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e2290611bf2565b60405180910390fd5b610e33611319565b6060604051908101604052808a8a80806020026020016040519081016040528093929190818152602001838360200280828437600081840152601f19601f8201169050808301925050505050505081526020018860ff1681526020018715158152509050610e9f6112d9565b60c060405190810160405280838152602001428863ffffffff16018152602001602060405190810160405280600081525081526020016020604051908101604052806000815250815260200186868080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050815260200160011515815250905080600360008d81526020019081526020016000206000820151816000016000820151816000019080519060200190610f77929190611340565b5060208201518160010160006101000a81548160ff021916908360ff16021790555060408201518160010160016101000a81548160ff0219169083151502179055505050602082015181600201556040820151816003019080519060200190610fe192919061138d565b506060820151816004019080519060200190610ffe92919061138d565b50608082015181600501908051906020019061101b92919061138d565b5060a08201518160060160006101000a81548160ff02191690831515021790555090505061104761140d565b6020604051908101604052905080600460008e8152602001908152602001600020905050505050505050505050505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561110a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161110190611b92565b60405180910390fd5b61111381611182565b50565b600042905090565b6001600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555061117f81611182565b50565b60018060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555050565b50805460008255906000526020600020908101906111fa919061141b565b50565b50805460018160011615610100020316600290046000825580601f106112235750611242565b601f0160209004906000526020600020908101906112419190611440565b5b50565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061128657803560ff19168380011785556112b4565b828001600101855582156112b4579182015b828111156112b3578235825591602001919060010190611298565b5b5090506112c19190611440565b5090565b602060405190810160405280600081525090565b610100604051908101604052806112ee611465565b8152602001600081526020016060815260200160608152602001606081526020016000151581525090565b60606040519081016040528060608152602001600060ff1681526020016000151581525090565b82805482825590600052602060002090810192821561137c579160200282015b8281111561137b578251825591602001919060010190611360565b5b509050611389919061141b565b5090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106113ce57805160ff19168380011785556113fc565b828001600101855582156113fc579182015b828111156113fb5782518255916020019190600101906113e0565b5b5090506114099190611440565b5090565b602060405190810160405290565b61143d91905b80821115611439576000816000905550600101611421565b5090565b90565b61146291905b8082111561145e576000816000905550600101611446565b5090565b90565b60606040519081016040528060608152602001600060ff1681526020016000151581525090565b60006114988235611cec565b905092915050565b60008083601f84011215156114b457600080fd5b8235905067ffffffffffffffff8111156114cd57600080fd5b6020830191508360208202830111156114e557600080fd5b9250929050565b60006114f88235611cfe565b905092915050565b600061150c8235611d0a565b905092915050565b60008083601f840112151561152857600080fd5b8235905067ffffffffffffffff81111561154157600080fd5b60208301915083600182028301111561155957600080fd5b9250929050565b600061156c8235611d14565b905092915050565b60006115808235611d24565b905092915050565b60006020828403121561159a57600080fd5b60006115a88482850161148c565b91505092915050565b6000602082840312156115c357600080fd5b60006115d184828501611500565b91505092915050565b6000806000606084860312156115ef57600080fd5b60006115fd86828701611500565b935050602061160e8682870161148c565b925050604061161f868287016114ec565b9150509250925092565b60008060008060008060008060c0898b03121561164557600080fd5b60006116538b828c01611500565b985050602089013567ffffffffffffffff81111561167057600080fd5b61167c8b828c016114a0565b9750975050604061168f8b828c01611574565b95505060606116a08b828c016114ec565b94505060806116b18b828c01611560565b93505060a089013567ffffffffffffffff8111156116ce57600080fd5b6116da8b828c01611514565b92509250509295985092959890939650565b60008060008060006060868803121561170457600080fd5b600061171288828901611500565b955050602086013567ffffffffffffffff81111561172f57600080fd5b61173b88828901611514565b9450945050604086013567ffffffffffffffff81111561175a57600080fd5b61176688828901611514565b92509250509295509295909350565b6000806000806060858703121561178b57600080fd5b600061179987828801611500565b94505060206117aa87828801611560565b935050604085013567ffffffffffffffff8111156117c757600080fd5b6117d387828801611514565b925092505092959194509250565b60006117ec82611c7c565b8084526020840193506117fe83611c6f565b60005b828110156118305761181486835161184b565b61181d82611c92565b9150602086019550600181019050611801565b50849250505092915050565b61184581611c9f565b82525050565b61185481611cab565b82525050565b600061186582611c87565b808452611879816020860160208601611d31565b61188281611d64565b602085010191505092915050565b6000601582527f4f7264657220646f6573206e6f742065786973742100000000000000000000006020830152604082019050919050565b6000601682527f496e74656e74696f6e2074696d652065787069726564000000000000000000006020830152604082019050919050565b6000602082527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65726020830152604082019050919050565b6000601782527f43616c6c6572206973206e6f74207468652061646d696e0000000000000000006020830152604082019050919050565b6000601982527f4f726465722068617320616c72656164792065786973747321000000000000006020830152604082019050919050565b6000602d82527f546865206f72646572206f6620747970652032206173736574206d757374206260208301527f6520636f6e73756d61626c6521000000000000000000000000000000000000006040830152606082019050919050565b6000601182527f54696d652045787069726564206e6f77210000000000000000000000000000006020830152604082019050919050565b60006060830160008301518482036000860152611a5482826117e1565b9150506020830151611a696020860182611b43565b506040830151611a7c604086018261183c565b508091505092915050565b600060c0830160008301518482036000860152611aa48282611a37565b9150506020830151611ab96020860182611b25565b5060408301518482036040860152611ad1828261185a565b91505060608301518482036060860152611aeb828261185a565b91505060808301518482036080860152611b05828261185a565b91505060a0830151611b1a60a086018261183c565b508091505092915050565b611b2e81611cd5565b82525050565b611b3d81611cd5565b82525050565b611b4c81611cdf565b82525050565b60006020820190508181036000830152611b6b81611890565b9050919050565b60006020820190508181036000830152611b8b816118c7565b9050919050565b60006020820190508181036000830152611bab816118fe565b9050919050565b60006020820190508181036000830152611bcb81611935565b9050919050565b60006020820190508181036000830152611beb8161196c565b9050919050565b60006020820190508181036000830152611c0b816119a3565b9050919050565b60006020820190508181036000830152611c2b81611a00565b9050919050565b60006020820190508181036000830152611c4c8184611a87565b905092915050565b6000602082019050611c696000830184611b34565b92915050565b6000602082019050919050565b600081519050919050565b600081519050919050565b6000602082019050919050565b60008115159050919050565b6000819050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600060ff82169050919050565b6000611cf782611cb5565b9050919050565b60008115159050919050565b6000819050919050565b600063ffffffff82169050919050565b600060ff82169050919050565b60005b83811015611d4f578082015181840152602081019050611d34565b83811115611d5e576000848401525b50505050565b6000601f19601f830116905091905056fea265627a7a72305820ec24c5bc93afd22cda275988585a82b8442a8be7e3b2eee3f2d46018adb747cd6c6578706572696d656e74616cf50037';

const Remote = jlib.Remote;
const contractRemote = new Remote({server: contractChain.server[0], local_sign: true});

contractRemote.connect(async function(err, res) {

    if(err) {
        return console.log('err: ', err);
    }
    else if(res) {
        console.log('connect: ', res);
    }

    let seq = (await requestInfo.requestAccountInfo(platformAddr, contractRemote, false)).account_data.Sequence;

    let deployRes = await contract.initContract(platformAddr, platformSecret, contractRemote, seq++, abi, payload, true);

    let contractAddr = deployRes.ContractState;
    let abiBuffer = Buffer.from(JSON.stringify(abi));
    let abiHash = await ipfsUtils.add(ipfs, abiBuffer);
    let contractInfo = {
        contract_addr: contractAddr,
        abi_hash: abiHash,
    }
    let sql = sqlText.table('contract_info').data(contractInfo).insert();
    console.log(contractInfo);//
    await mysqlUtils.sql(c, sql);

    contractRemote.disconnect();

})


// import jlib from 'jingtum-lib';
// var Remote = jlib.Remote;
// var remote = new Remote({server: 'ws://39.102.92.229:6030', local_sign:true});
// remote.connect(function (err, result) {
//     if (err) {
//         return console.log('err:', err);
//     }
//      var v = {
//         address: 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh',
//         secret: 'snoPBjXtMeMyMHUVTgbuqAfg1SUTb'
// };
//     const abi = [
//         {
//             "constant": true,
//             "inputs": [],
//             "name": "name",
//             "outputs": [
//                 {
//                     "name": "",
//                     "type": "string"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "view",
//             "type": "function"
//         },
//         {
//             "constant": true,
//             "inputs": [],
//             "name": "totalSupply",
//             "outputs": [
//                 {
//                     "name": "",
//                     "type": "uint256"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "view",
//             "type": "function"
//         },
//         {
//             "constant": true,
//             "inputs": [],
//             "name": "decimals",
//             "outputs": [
//                 {
//                     "name": "",
//                     "type": "uint8"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "view",
//             "type": "function"
//         },
//         {
//             "constant": true,
//             "inputs": [
//                 {
//                     "name": "",
//                     "type": "address"
//                 }
//             ],
//             "name": "balanceOf",
//             "outputs": [
//                 {
//                     "name": "",
//                     "type": "uint256"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "view",
//             "type": "function"
//         },
//         {
//             "constant": true,
//             "inputs": [],
//             "name": "symbol",
//             "outputs": [
//                 {
//                     "name": "",
//                     "type": "string"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "view",
//             "type": "function"
//         },
//         {
//             "constant": false,
//             "inputs": [
//                 {
//                     "name": "_to",
//                     "type": "address"
//                 },
//                 {
//                     "name": "_value",
//                     "type": "uint256"
//                 }
//             ],
//             "name": "transfer",
//             "outputs": [],
//             "payable": false,
//             "stateMutability": "nonpayable",
//             "type": "function"
//         },
//         {
//             "constant": true,
//             "inputs": [
//                 {
//                     "name": "",
//                     "type": "address"
//                 },
//                 {
//                     "name": "",
//                     "type": "address"
//                 }
//             ],
//             "name": "allowance",
//             "outputs": [
//                 {
//                     "name": "",
//                     "type": "uint256"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "view",
//             "type": "function"
//         },
//         {
//             "inputs": [
//                 {
//                     "name": "initialSupply",
//                     "type": "uint256"
//                 },
//                 {
//                     "name": "tokenName",
//                     "type": "string"
//                 },
//                 {
//                     "name": "tokenSymbol",
//                     "type": "string"
//                 }
//             ],
//             "payable": false,
//             "stateMutability": "nonpayable",
//             "type": "constructor"
//         },
//         {
//             "payable": false,
//             "stateMutability": "nonpayable",
//             "type": "fallback"
//         }
//     ];
// var tx = remote.initContract({
// 	 account: v.address, 
//     amount: 10,
//     payload: '60606040526012600260006101000a81548160ff021916908360ff160217905550341561002b57600080fd5b60405161092738038061092783398101604052808051906020019091908051820191906020018051820191905050600260009054906101000a900460ff1660ff16600a0a8302600381905550600354600460003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555081600090805190602001906100d39291906100f3565b5080600190805190602001906100ea9291906100f3565b50505050610198565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061013457805160ff1916838001178555610162565b82800160010185558215610162579182015b82811115610161578251825591602001919060010190610146565b5b50905061016f9190610173565b5090565b61019591905b80821115610191576000816000905550600101610179565b5090565b90565b610780806101a76000396000f300606060405260043610610083576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde031461009357806318160ddd14610121578063313ce5671461014a57806370a082311461017957806395d89b41146101c6578063a9059cbb14610254578063dd62ed3e14610296575b341561008e57600080fd5b600080fd5b341561009e57600080fd5b6100a6610302565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100e65780820151818401526020810190506100cb565b50505050905090810190601f1680156101135780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561012c57600080fd5b6101346103a0565b6040518082815260200191505060405180910390f35b341561015557600080fd5b61015d6103a6565b604051808260ff1660ff16815260200191505060405180910390f35b341561018457600080fd5b6101b0600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b9565b6040518082815260200191505060405180910390f35b34156101d157600080fd5b6101d96103d1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102195780820151818401526020810190506101fe565b50505050905090810190601f1680156102465780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561025f57600080fd5b610294600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061046f565b005b34156102a157600080fd5b6102ec600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061047e565b6040518082815260200191505060405180910390f35b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156103985780601f1061036d57610100808354040283529160200191610398565b820191906000526020600020905b81548152906001019060200180831161037b57829003601f168201915b505050505081565b60035481565b600260009054906101000a900460ff1681565b60046020528060005260406000206000915090505481565b60018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104675780601f1061043c57610100808354040283529160200191610467565b820191906000526020600020905b81548152906001019060200180831161044a57829003601f168201915b505050505081565b61047a3383836104a3565b5050565b6005602052816000526040600020602052806000526040600020600091509150505481565b6000808373ffffffffffffffffffffffffffffffffffffffff16141515156104ca57600080fd5b81600460008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541015151561051857600080fd5b600460008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205482600460008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054011115156105a657600080fd5b600460008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054600460008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205401905081600460008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555081600460008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254019250508190555080600460008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054600460008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540114151561074e57fe5b505050505600a165627a7a72305820b2665df0d8d8522803a19ac6bc98ff010121e11c16d0342eaced01d94100ce180029',
//    abi: abi,
//    params:[2000, 'TestCurrency', 'TEST1']
// });
//     tx.setSecret(v.secret);
//     tx.submit(function (err, result) {
//         if (err) {
//             console.log('err:', err);
//         }
//         else if (result) {
//             console.log('res:', result);
//         }
//     });
// });
